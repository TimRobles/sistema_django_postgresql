{% extends 'base.html' %}
{% load static %}

{% block titulo %}
    Detalle Oferta Proveedor
{% endblock titulo %}

{% block contenido %}
    <h3>Detalle Oferta Proveedor
        {% if contexto_oferta_proveedor.estado == 1 %}
            <button data-form-url="{% url 'oferta_proveedor_app:oferta_proveedor_finalizar' contexto_oferta_proveedor.id %}"
                data-table-url="{% url 'oferta_proveedor_app:oferta_proveedor_inicio' %}"
                class="delete badge bg-primary">
                Finalizar Oferta
            </button>
        {% endif %}
        {% if contexto_oferta_proveedor.estado != 1 and contexto_oferta_proveedor.estado != 3 %}
            <button data-form-url="{% url 'oferta_proveedor_app:oferta_proveedor_rechazar' contexto_oferta_proveedor.id %}"
                data-table-url="{% url 'oferta_proveedor_app:oferta_proveedor_inicio' %}"
                class="delete badge bg-primary">
                Rechazar Oferta
            </button>
        {% endif %}
        <a href="{% url 'oferta_proveedor_app:oferta_proveedor_inicio' %}"><span class="badge bg-primary">Regresar</span></a>
    </h3>
    <h3>
    {% if contexto_oferta_proveedor.estado != 1 and contexto_oferta_proveedor.estado != 3 %}
        <button data-form-url="{% url 'oferta_proveedor_app:oferta_proveedor_generar_nuevo_requerimiento' contexto_oferta_proveedor.slug %}"
            data-table-url="{% url 'oferta_proveedor_app:oferta_proveedor_inicio' %}"
            class="delete badge bg-primary">
            Generar Nuevo Requerimiento
        </button>
    {% endif %}

    {% if contexto_oferta_proveedor.estado != 1 and contexto_oferta_proveedor.estado != 3 and not contexto_oferta_proveedor.OrdenCompra_oferta_proveedor %}
        <button data-form-url="{% url 'oferta_proveedor_app:oferta_proveedor_generar_orden_compra' contexto_oferta_proveedor.slug %}"
            class="delete badge bg-primary">
            Generar Orden de Compra
        </button>
    {% endif %}

    <a href="{% url 'requerimiento_material_app:requerimiento_material_proveedor_detalle' contexto_oferta_proveedor.requerimiento_material.id %}"><span class="badge bg-primary">Requerimiento</span></a>
    
    {% if contexto_oferta_proveedor.OrdenCompra_oferta_proveedor %}
        <a href="{% url 'orden_compra_app:orden_compra_detalle' contexto_oferta_proveedor.OrdenCompra_oferta_proveedor.slug %}"><span class="badge bg-primary">Orden de Compra</span></a>
    {% endif %}
        
    </h3>
    <br>
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Proveedor</th>
                    <th>Interlocutor</th>
                    <th>Comentario</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{ contexto_oferta_proveedor.requerimiento_material.fecha|date:'d/m/Y' }}</td>
                    <td>{{ contexto_oferta_proveedor.requerimiento_material.proveedor }}</td>
                    <td>{{ contexto_oferta_proveedor.requerimiento_material.interlocutor_proveedor }}</td>
                    <td>{{ contexto_oferta_proveedor.requerimiento_material.comentario }}</td>
                    <td>{{ contexto_oferta_proveedor.get_estado_display }}</td>

                </tr>
            </tbody>
        </table>
    </div>
    <br>
    <h3>Materiales
        {% if contexto_oferta_proveedor.estado == 1 %}
            <button data-form-url="{% url 'oferta_proveedor_app:oferta_proveedor_agregar_material' contexto_oferta_proveedor.slug %}"
                data-table-url="{% url 'oferta_proveedor_app:oferta_proveedor_detalle_tabla' contexto_oferta_proveedor.slug %}"
                class="create badge bg-primary">
                Agregar Material
            </button>
            <button data-form-url="{% url 'oferta_proveedor_app:oferta_proveedor_crear_material' contexto_oferta_proveedor.slug %}"
                data-table-url="{% url 'oferta_proveedor_app:oferta_proveedor_detalle_tabla' contexto_oferta_proveedor.slug %}"
                class="create badge bg-primary">
                Crear Material
            </button>
        {% endif %}
    </h3>
    <div id="tabla">
        {% include 'oferta_proveedor/oferta_proveedor/detalle_tabla.html' %}
    </div>


{% endblock contenido %}
